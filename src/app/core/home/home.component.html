<app-top-menu></app-top-menu>
<div class="d-flex content-panel">
  <div class="listings-panel" id="listings-panel">
    <div class="panel-header">
      <span style="width: 100%; height: 100%;"> Nearest tech </span>
    </div>
    <hr>
    <div class="searchOptionsRow">
      <button id="sort" class="horizontal icon filter" (click)="toggleSort()">
        Sort
      </button>
      <button id="filter" class="horizontal icon sort" (click)="toggleFilters()">
        Filter
      </button>
    </div>
    <ng-container *ngIf="showSort">
      <div class="search-container">
        <span class="search-header searchOptionsRow">Sort</span>

        <span class="searchOptionsRow">
          <input type="radio" value="false" name="sortReversed" [(ngModel)]="toolsRequest.sortReversed"> Ascending
          <input type="radio" value="true" name="sortReversed" checked [(ngModel)]="toolsRequest.sortReversed"> Descending
        </span>

        <hr/>

        <span class="optionsList">
          <span>
            <input type="radio" value="price" name="sort" [(ngModel)]="toolsRequest.sortBy"> Price
          </span>
          <span>
            <input type="radio" value="category" name="sort" [(ngModel)]="toolsRequest.sortBy"> Category
          </span>
          <span>
            <input type="radio" value="name" name="sort" [(ngModel)]="toolsRequest.sortBy"> Name
          </span>
        </span>

        <span class="searchOptionsRow">
          <button id="submitSort" class="submitButton" (click)="submitSort()">
            Sort
          </button>
        </span>
      </div>
    </ng-container>

    <ng-container *ngIf="showFilters">
      <div class="search-container ">
        <span class="search-header searchOptionsRow">Filter</span>

        <div class="searchOptionsRow">
          <h2>Price</h2>
          <span>
            <input class="priceInput" type="number" name="minPrice" min="0" placeholder="From"
                   [(ngModel)]="toolsRequest.minPrice">
          </span>
          <span>
            <input class="priceInput" type="number" name="maxPrice" min="0" placeholder="To"
                   [(ngModel)]="toolsRequest.maxPrice">
          </span>
        </div>
        <hr/>
        <div class="searchOptionsRow">
          <h2>Category</h2>
          <ul class="no-list-style-type">
            <li class="categoryOption" *ngFor="let category of categories">
              <input type="checkbox" [value]="category.id" (change)="onCheckboxChange($event)"/>{{category.name}}
            </li>
          </ul>
        </div>
        <span class="searchOptionsRow">
          <button id="submitFilter" class="submitButton" (click)="submitSort()">
            Filter
          </button>
        </span>
      </div>
    </ng-container>
    <div>
      <ul class="tool-list">
        <li *ngFor="let tool of tools" class="listing-row mt-1">
          <div class="listing" (click)="toolClicked(tool)">

            <span class="circle" [ngClass]="{'available': tool.available}"></span>
            <img src="../assets/icons/{{tool.toolCategory}}.png" class="category-icon"/>
            <div class="listing-name">
            <span>
              {{tool.name}}
            </span>
              <div class="listing-price">
                {{tool.price}}â‚¬/d.
              </div>
            </div>
          </div>
          <a class="open-arrow" routerLink="/tool/{{tool.id}}"></a>
        </li>
      </ul>
    </div>
  </div>
  <div class="flex-grow-1">
    <google-map [zoom]="zoom" (zoomChanged)="changeMapZoom($event)" [options]="options" class="fullscreen" *ngIf="!showProfile">
      <map-marker *ngFor="let markerPosition of markerPositions"
                  [position]="markerPosition"
                  [options]="markerOptions">
        <map-info-window>{{toolDetailsInfoWindow.name}} -- {{toolDetailsInfoWindow.price}}
          <a routerLink="/tool/{{toolDetailsInfoWindow.id}}">Details</a></map-info-window>
      </map-marker>
    </google-map>
  </div>
</div>
